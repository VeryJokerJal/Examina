# BenchSuite Windows 测试功能

## 概述

BenchSuite.Console 现在支持 Windows 系统操作的自动化测试功能，可以检测和验证 27 种不同类型的 Windows 操作，包括文件系统操作、注册表操作、服务管理、进程控制等。

## 功能特性

### 支持的操作类型

#### 1. 文件操作 (5种)
- 创建文件
- 删除文件
- 复制文件
- 移动文件
- 重命名文件

#### 2. 文件夹操作 (5种)
- 创建文件夹
- 删除文件夹
- 复制文件夹
- 移动文件夹
- 重命名文件夹

#### 3. 文件属性操作 (2种)
- 设置文件属性
- 设置文件权限

#### 4. 文件内容操作 (2种)
- 写入文本到文件
- 追加文本到文件

#### 5. 系统操作 (2种)
- 创建快捷方式
- 设置环境变量

#### 6. 注册表操作 (3种)
- 创建注册表项
- 设置注册表值
- 删除注册表项

#### 7. 服务操作 (2种)
- 启动服务
- 停止服务

#### 8. 进程操作 (2种)
- 启动进程
- 终止进程

#### 9. 网络操作 (2种)
- Ping主机
- 下载文件

#### 10. 压缩操作 (2种)
- 创建ZIP压缩包
- 解压ZIP压缩包

## 使用方法

### 命令行运行

```bash
# 使用默认测试数据
BenchSuite.Console.exe windows

# 使用自定义测试数据
BenchSuite.Console.exe windows "path\to\your\windows-test-exam.json"
```

### 批处理脚本运行

```bash
# 运行提供的批处理脚本
run-windows-test.bat
```

## 测试流程

1. **加载试卷模型**: 从JSON文件加载Windows操作测试配置
2. **执行30轮测试**: 自动执行30次评分以测试稳定性
3. **实时状态检测**: 检测当前系统状态，验证操作是否完成
4. **结果分析**: 提供详细的稳定性分析和性能统计

## 测试结果分析

### 稳定性分析
- **总分稳定性**: 检查多次评分的总分是否一致
- **得分稳定性**: 分析得分的变化范围和标准差
- **知识点稳定性**: 按类别分析每个知识点的检测稳定性

### 性能分析
- **评分耗时统计**: 平均、最短、最长耗时
- **性能等级评估**: 根据耗时给出性能等级
- **知识点效率**: 每个知识点的平均检测时间

### 详细报告
- **成功率统计**: 每种操作类型的检测成功率
- **错误信息**: 详细的错误信息和诊断建议
- **操作详情**: 每个操作的具体检测结果

## 测试数据格式

测试数据使用JSON格式，包含以下结构：

```json
{
  "id": "windows-test-001",
  "name": "Windows系统操作综合测试",
  "modules": [
    {
      "type": "Windows",
      "questions": [
        {
          "operationPoints": [
            {
              "name": "创建文件",
              "moduleType": "Windows",
              "parameters": [
                {
                  "name": "FilePath",
                  "value": "C:\\TestFiles\\test-file.txt"
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
```

## 注意事项

### 系统要求
- Windows 操作系统
- .NET 8.0 运行时
- 管理员权限（某些操作需要）

### 安全考虑
- 测试会检测系统当前状态，不会修改系统
- 某些操作（如注册表、服务）需要适当权限
- 建议在测试环境中运行

### 测试路径
- 默认测试路径使用 `C:\TestFiles\` 和 `C:\TestFolders\`
- 确保测试路径存在或程序有创建权限
- 可以通过修改JSON配置文件自定义测试路径

## 故障排除

### 常见问题

1. **权限不足**
   - 以管理员身份运行程序
   - 检查文件系统权限

2. **路径不存在**
   - 确保测试路径存在
   - 检查路径格式是否正确

3. **服务不存在**
   - 验证服务名称是否正确
   - 检查服务是否已安装

4. **网络连接问题**
   - 检查网络连接
   - 验证防火墙设置

## 扩展功能

### 自定义测试
- 修改 `windows-test-exam.json` 文件添加自定义测试
- 支持所有27种操作类型的任意组合
- 可以调整评分权重和参数

### 集成测试
- 可以与现有的PowerPoint测试功能并行使用
- 支持混合模式测试（同时测试多种模块类型）

## 技术架构

- **WindowsScoringService**: 核心评分服务
- **WindowsKnowledgeService**: 知识点配置管理
- **WindowsTestProgram**: 测试程序入口
- **ExamModelLoader**: 试卷模型加载器

## 版本信息

- 版本: 1.0.0
- 支持的Windows版本: Windows 10/11
- .NET版本: 8.0
- 最后更新: 2025年1月
