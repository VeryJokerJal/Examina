@using ExaminaWebApplication.Models.Windows
@{
    var createOperations = ViewBag.CreateOperations as List<WindowsOperationPoint>;
    var copyOperations = ViewBag.CopyOperations as List<WindowsOperationPoint>;
    var moveOperations = ViewBag.MoveOperations as List<WindowsOperationPoint>;
    var deleteOperations = ViewBag.DeleteOperations as List<WindowsOperationPoint>;
    var renameOperations = ViewBag.RenameOperations as List<WindowsOperationPoint>;
    var shortcutOperations = ViewBag.ShortcutOperations as List<WindowsOperationPoint>;
    var propertyOperations = ViewBag.PropertyOperations as List<WindowsOperationPoint>;
    var copyRenameOperations = ViewBag.CopyRenameOperations as List<WindowsOperationPoint>;
}

<!-- 页面标题 -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h1 class="h3 mb-0">
            <i class="bi bi-windows me-2"></i>Windows操作点
        </h1>
        <p class="text-muted mb-0">管理Windows文件系统操作点</p>
    </div>
    <div>
        <button class="glass-btn glass-btn-primary" onclick="refreshOperations()">
            <i class="bi bi-arrow-clockwise"></i> 刷新数据
        </button>
        <button class="glass-btn glass-btn-success" onclick="initializeWindowsData()">
            <i class="bi bi-database-add"></i> 初始化数据
        </button>
        <a href="/api/WindowsTest/statistics" target="_blank" class="glass-btn glass-btn-info">
            <i class="bi bi-bar-chart"></i> 查看统计
        </a>
    </div>
</div>

<!-- 操作统计卡片 -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="glass-card text-center">
            <div class="card-body">
                <i class="bi bi-plus-circle text-success" style="font-size: 2rem;"></i>
                <h5 class="mt-2">创建操作</h5>
                <h3 class="text-success">@(createOperations?.Count ?? 0)</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="glass-card text-center">
            <div class="card-body">
                <i class="bi bi-files text-primary" style="font-size: 2rem;"></i>
                <h5 class="mt-2">复制操作</h5>
                <h3 class="text-primary">@((copyOperations?.Count ?? 0) + (copyRenameOperations?.Count ?? 0))</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="glass-card text-center">
            <div class="card-body">
                <i class="bi bi-arrow-right-square text-warning" style="font-size: 2rem;"></i>
                <h5 class="mt-2">移动/重命名</h5>
                <h3 class="text-warning">@((moveOperations?.Count ?? 0) + (renameOperations?.Count ?? 0))</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="glass-card text-center">
            <div class="card-body">
                <i class="bi bi-trash text-danger" style="font-size: 2rem;"></i>
                <h5 class="mt-2">删除/属性</h5>
                <h3 class="text-danger">@((deleteOperations?.Count ?? 0) + (propertyOperations?.Count ?? 0) + (shortcutOperations?.Count ?? 0))</h3>
            </div>
        </div>
    </div>
</div>

<!-- 搜索和筛选 -->
<div class="glass-card mb-4">
    <div class="card-body">
        <div class="row">
            <div class="col-md-4">
                <label for="searchInput" class="form-label">搜索操作点</label>
                <input type="text" class="form-control" id="searchInput" placeholder="输入操作点名称或描述..." onkeyup="filterOperations()">
            </div>
            <div class="col-md-3">
                <label for="typeFilter" class="form-label">操作类型筛选</label>
                <select class="form-select" id="typeFilter" onchange="filterOperations()">
                    <option value="">全部类型</option>
                    <option value="create">创建操作</option>
                    <option value="copy">复制操作</option>
                    <option value="move">移动操作</option>
                    <option value="delete">删除操作</option>
                    <option value="rename">重命名操作</option>
                    <option value="shortcut">快捷方式</option>
                    <option value="property">属性操作</option>
                    <option value="copyrename">复制重命名</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="modeFilter" class="form-label">操作模式</label>
                <select class="form-select" id="modeFilter" onchange="filterOperations()">
                    <option value="">全部模式</option>
                    <option value="file">文件模式</option>
                    <option value="folder">文件夹模式</option>
                    <option value="universal">通用模式</option>
                </select>
            </div>
            <div class="col-md-2">
                <label class="form-label">&nbsp;</label>
                <button class="glass-btn glass-btn-primary w-100" onclick="clearFilters()">
                    <i class="bi bi-x-circle"></i> 清除筛选
                </button>
            </div>
        </div>
    </div>
</div>

<!-- 操作点列表 -->
<div class="row">
    <!-- 创建操作 -->
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="glass-card">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">
                    <i class="bi bi-plus-circle me-2"></i>创建操作 (@(createOperations?.Count ?? 0))
                </h5>
            </div>
            <div class="card-body p-0" style="max-height: 400px; overflow-y: auto;">
                @if (createOperations != null && createOperations.Any())
                {
                    @foreach (var operation in createOperations)
                    {
                        <div class="operation-item p-3 border-bottom" 
                             data-type="create" 
                             data-mode="@operation.OperationMode.ToString().ToLower()"
                             data-name="@operation.Name.ToLower()" 
                             data-description="@operation.Description?.ToLower()" 
                             data-parameters="@operation.Parameters.Count"
                             onclick="selectOperation(@operation.OperationNumber, '@operation.Name')">
                            <div class="d-flex justify-content-between align-items-start">
                                <h6 class="mb-1">操作点 @operation.OperationNumber</h6>
                                <span class="badge bg-secondary">@operation.Parameters.Count 参数</span>
                            </div>
                            <h6 class="text-success mb-1">@operation.Name</h6>
                            <p class="text-muted small mb-2">@operation.Description</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-info">@operation.OperationMode</small>
                                <button class="glass-btn glass-btn-primary btn-sm" onclick="event.stopPropagation(); viewOperationDetails(@operation.OperationNumber)">
                                    <i class="bi bi-eye"></i> 详情
                                </button>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="p-3 text-center text-muted">
                        <i class="bi bi-inbox"></i>
                        <p class="mb-0">暂无创建操作</p>
                    </div>
                }
            </div>
        </div>
    </div>

    <!-- 复制操作 -->
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="glass-card">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i class="bi bi-files me-2"></i>复制操作 (@(copyOperations?.Count ?? 0))
                </h5>
            </div>
            <div class="card-body p-0" style="max-height: 400px; overflow-y: auto;">
                @if (copyOperations != null && copyOperations.Any())
                {
                    @foreach (var operation in copyOperations)
                    {
                        <div class="operation-item p-3 border-bottom" 
                             data-type="copy" 
                             data-mode="@operation.OperationMode.ToString().ToLower()"
                             data-name="@operation.Name.ToLower()" 
                             data-description="@operation.Description?.ToLower()" 
                             data-parameters="@operation.Parameters.Count"
                             onclick="selectOperation(@operation.OperationNumber, '@operation.Name')">
                            <div class="d-flex justify-content-between align-items-start">
                                <h6 class="mb-1">操作点 @operation.OperationNumber</h6>
                                <span class="badge bg-secondary">@operation.Parameters.Count 参数</span>
                            </div>
                            <h6 class="text-primary mb-1">@operation.Name</h6>
                            <p class="text-muted small mb-2">@operation.Description</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-info">@operation.OperationMode</small>
                                <button class="glass-btn glass-btn-primary btn-sm" onclick="event.stopPropagation(); viewOperationDetails(@operation.OperationNumber)">
                                    <i class="bi bi-eye"></i> 详情
                                </button>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="p-3 text-center text-muted">
                        <i class="bi bi-inbox"></i>
                        <p class="mb-0">暂无复制操作</p>
                    </div>
                }
            </div>
        </div>
    </div>

    <!-- 移动操作 -->
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="glass-card">
            <div class="card-header bg-warning text-white">
                <h5 class="mb-0">
                    <i class="bi bi-arrow-right-square me-2"></i>移动操作 (@(moveOperations?.Count ?? 0))
                </h5>
            </div>
            <div class="card-body p-0" style="max-height: 400px; overflow-y: auto;">
                @if (moveOperations != null && moveOperations.Any())
                {
                    @foreach (var operation in moveOperations)
                    {
                        <div class="operation-item p-3 border-bottom" 
                             data-type="move" 
                             data-mode="@operation.OperationMode.ToString().ToLower()"
                             data-name="@operation.Name.ToLower()" 
                             data-description="@operation.Description?.ToLower()" 
                             data-parameters="@operation.Parameters.Count"
                             onclick="selectOperation(@operation.OperationNumber, '@operation.Name')">
                            <div class="d-flex justify-content-between align-items-start">
                                <h6 class="mb-1">操作点 @operation.OperationNumber</h6>
                                <span class="badge bg-secondary">@operation.Parameters.Count 参数</span>
                            </div>
                            <h6 class="text-warning mb-1">@operation.Name</h6>
                            <p class="text-muted small mb-2">@operation.Description</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-info">@operation.OperationMode</small>
                                <button class="glass-btn glass-btn-primary btn-sm" onclick="event.stopPropagation(); viewOperationDetails(@operation.OperationNumber)">
                                    <i class="bi bi-eye"></i> 详情
                                </button>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="p-3 text-center text-muted">
                        <i class="bi bi-inbox"></i>
                        <p class="mb-0">暂无移动操作</p>
                    </div>
                }
            </div>
        </div>
    </div>

    <!-- 删除操作 -->
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="glass-card">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0">
                    <i class="bi bi-trash me-2"></i>删除操作 (@(deleteOperations?.Count ?? 0))
                </h5>
            </div>
            <div class="card-body p-0" style="max-height: 400px; overflow-y: auto;">
                @if (deleteOperations != null && deleteOperations.Any())
                {
                    @foreach (var operation in deleteOperations)
                    {
                        <div class="operation-item p-3 border-bottom"
                             data-type="delete"
                             data-mode="@operation.OperationMode.ToString().ToLower()"
                             data-name="@operation.Name.ToLower()"
                             data-description="@operation.Description?.ToLower()"
                             data-parameters="@operation.Parameters.Count"
                             onclick="selectOperation(@operation.OperationNumber, '@operation.Name')">
                            <div class="d-flex justify-content-between align-items-start">
                                <h6 class="mb-1">操作点 @operation.OperationNumber</h6>
                                <span class="badge bg-secondary">@operation.Parameters.Count 参数</span>
                            </div>
                            <h6 class="text-danger mb-1">@operation.Name</h6>
                            <p class="text-muted small mb-2">@operation.Description</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-info">@operation.OperationMode</small>
                                <button class="glass-btn glass-btn-primary btn-sm" onclick="event.stopPropagation(); viewOperationDetails(@operation.OperationNumber)">
                                    <i class="bi bi-eye"></i> 详情
                                </button>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="p-3 text-center text-muted">
                        <i class="bi bi-inbox"></i>
                        <p class="mb-0">暂无删除操作</p>
                    </div>
                }
            </div>
        </div>
    </div>

    <!-- 重命名操作 -->
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="glass-card">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">
                    <i class="bi bi-pencil-square me-2"></i>重命名操作 (@(renameOperations?.Count ?? 0))
                </h5>
            </div>
            <div class="card-body p-0" style="max-height: 400px; overflow-y: auto;">
                @if (renameOperations != null && renameOperations.Any())
                {
                    @foreach (var operation in renameOperations)
                    {
                        <div class="operation-item p-3 border-bottom"
                             data-type="rename"
                             data-mode="@operation.OperationMode.ToString().ToLower()"
                             data-name="@operation.Name.ToLower()"
                             data-description="@operation.Description?.ToLower()"
                             data-parameters="@operation.Parameters.Count"
                             onclick="selectOperation(@operation.OperationNumber, '@operation.Name')">
                            <div class="d-flex justify-content-between align-items-start">
                                <h6 class="mb-1">操作点 @operation.OperationNumber</h6>
                                <span class="badge bg-secondary">@operation.Parameters.Count 参数</span>
                            </div>
                            <h6 class="text-info mb-1">@operation.Name</h6>
                            <p class="text-muted small mb-2">@operation.Description</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-info">@operation.OperationMode</small>
                                <button class="glass-btn glass-btn-primary btn-sm" onclick="event.stopPropagation(); viewOperationDetails(@operation.OperationNumber)">
                                    <i class="bi bi-eye"></i> 详情
                                </button>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="p-3 text-center text-muted">
                        <i class="bi bi-inbox"></i>
                        <p class="mb-0">暂无重命名操作</p>
                    </div>
                }
            </div>
        </div>
    </div>

    <!-- 其他操作（快捷方式、属性、复制重命名） -->
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="glass-card">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0">
                    <i class="bi bi-gear me-2"></i>其他操作 (@((shortcutOperations?.Count ?? 0) + (propertyOperations?.Count ?? 0) + (copyRenameOperations?.Count ?? 0)))
                </h5>
            </div>
            <div class="card-body p-0" style="max-height: 400px; overflow-y: auto;">
                @if (shortcutOperations != null && shortcutOperations.Any())
                {
                    @foreach (var operation in shortcutOperations)
                    {
                        <div class="operation-item p-3 border-bottom"
                             data-type="shortcut"
                             data-mode="@operation.OperationMode.ToString().ToLower()"
                             data-name="@operation.Name.ToLower()"
                             data-description="@operation.Description?.ToLower()"
                             data-parameters="@operation.Parameters.Count"
                             onclick="selectOperation(@operation.OperationNumber, '@operation.Name')">
                            <div class="d-flex justify-content-between align-items-start">
                                <h6 class="mb-1">操作点 @operation.OperationNumber</h6>
                                <span class="badge bg-secondary">@operation.Parameters.Count 参数</span>
                            </div>
                            <h6 class="text-secondary mb-1">@operation.Name</h6>
                            <p class="text-muted small mb-2">@operation.Description</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-info">@operation.OperationMode</small>
                                <button class="glass-btn glass-btn-primary btn-sm" onclick="event.stopPropagation(); viewOperationDetails(@operation.OperationNumber)">
                                    <i class="bi bi-eye"></i> 详情
                                </button>
                            </div>
                        </div>
                    }
                }
                @if (propertyOperations != null && propertyOperations.Any())
                {
                    @foreach (var operation in propertyOperations)
                    {
                        <div class="operation-item p-3 border-bottom"
                             data-type="property"
                             data-mode="@operation.OperationMode.ToString().ToLower()"
                             data-name="@operation.Name.ToLower()"
                             data-description="@operation.Description?.ToLower()"
                             data-parameters="@operation.Parameters.Count"
                             onclick="selectOperation(@operation.OperationNumber, '@operation.Name')">
                            <div class="d-flex justify-content-between align-items-start">
                                <h6 class="mb-1">操作点 @operation.OperationNumber</h6>
                                <span class="badge bg-secondary">@operation.Parameters.Count 参数</span>
                            </div>
                            <h6 class="text-secondary mb-1">@operation.Name</h6>
                            <p class="text-muted small mb-2">@operation.Description</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-info">@operation.OperationMode</small>
                                <button class="glass-btn glass-btn-primary btn-sm" onclick="event.stopPropagation(); viewOperationDetails(@operation.OperationNumber)">
                                    <i class="bi bi-eye"></i> 详情
                                </button>
                            </div>
                        </div>
                    }
                }
                @if (copyRenameOperations != null && copyRenameOperations.Any())
                {
                    @foreach (var operation in copyRenameOperations)
                    {
                        <div class="operation-item p-3 border-bottom"
                             data-type="copyrename"
                             data-mode="@operation.OperationMode.ToString().ToLower()"
                             data-name="@operation.Name.ToLower()"
                             data-description="@operation.Description?.ToLower()"
                             data-parameters="@operation.Parameters.Count"
                             onclick="selectOperation(@operation.OperationNumber, '@operation.Name')">
                            <div class="d-flex justify-content-between align-items-start">
                                <h6 class="mb-1">操作点 @operation.OperationNumber</h6>
                                <span class="badge bg-secondary">@operation.Parameters.Count 参数</span>
                            </div>
                            <h6 class="text-secondary mb-1">@operation.Name</h6>
                            <p class="text-muted small mb-2">@operation.Description</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-info">@operation.OperationMode</small>
                                <button class="glass-btn glass-btn-primary btn-sm" onclick="event.stopPropagation(); viewOperationDetails(@operation.OperationNumber)">
                                    <i class="bi bi-eye"></i> 详情
                                </button>
                            </div>
                        </div>
                    }
                }
                @if ((shortcutOperations == null || !shortcutOperations.Any()) &&
                     (propertyOperations == null || !propertyOperations.Any()) &&
                     (copyRenameOperations == null || !copyRenameOperations.Any()))
                {
                    <div class="p-3 text-center text-muted">
                        <i class="bi bi-inbox"></i>
                        <p class="mb-0">暂无其他操作</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<!-- 操作详情模态框 -->
<div class="modal fade" id="operationDetailsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Windows操作点详情</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="operationDetailsContent">
                <!-- 详情内容将通过JavaScript加载 -->
            </div>
            <div class="modal-footer">
                <button type="button" class="glass-btn" data-bs-dismiss="modal">关闭</button>
                <button type="button" class="glass-btn glass-btn-primary" onclick="createQuestionFromOperation()">创建题目</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        let selectedOperationNumber = null;
        let selectedOperationName = null;

        // 筛选操作点
        function filterOperations() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const typeFilter = document.getElementById('typeFilter').value;
            const modeFilter = document.getElementById('modeFilter').value;

            const operationItems = document.querySelectorAll('.operation-item');

            operationItems.forEach(item => {
                const name = item.getAttribute('data-name') || '';
                const description = item.getAttribute('data-description') || '';
                const type = item.getAttribute('data-type') || '';
                const mode = item.getAttribute('data-mode') || '';

                const matchesSearch = name.includes(searchTerm) || description.includes(searchTerm);
                const matchesType = !typeFilter || type === typeFilter;
                const matchesMode = !modeFilter || mode === modeFilter;

                if (matchesSearch && matchesType && matchesMode) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // 清除筛选
        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('typeFilter').value = '';
            document.getElementById('modeFilter').value = '';
            filterOperations();
        }

        // 选择操作点
        function selectOperation(operationNumber, operationName) {
            // 移除之前的选中状态
            document.querySelectorAll('.operation-item').forEach(item => {
                item.classList.remove('selected', 'bg-light');
            });

            // 添加选中状态
            event.target.closest('.operation-item').classList.add('selected', 'bg-light');

            selectedOperationNumber = operationNumber;
            selectedOperationName = operationName;

            showNotification(`已选择操作点 ${operationNumber}: ${operationName}`, 'info');
        }

        // 查看操作详情
        async function viewOperationDetails(operationNumber) {
            try {
                const response = await fetch(`/api/WindowsTest/operation-point/${operationNumber}`);
                if (response.ok) {
                    const operation = await response.json();
                    displayOperationDetails(operation);

                    const modal = new bootstrap.Modal(document.getElementById('operationDetailsModal'));
                    modal.show();
                } else {
                    showNotification('获取操作详情失败', 'danger');
                }
            } catch (error) {
                console.error('获取操作详情失败:', error);
                showNotification('获取操作详情失败', 'danger');
            }
        }

        // 显示操作详情
        function displayOperationDetails(operation) {
            const content = document.getElementById('operationDetailsContent');

            let parametersHtml = '';
            if (operation.parameters && operation.parameters.length > 0) {
                parametersHtml = `
                    <h6>参数配置：</h6>
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>序号</th>
                                    <th>参数名称</th>
                                    <th>数据类型</th>
                                    <th>必填</th>
                                    <th>示例值</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${operation.parameters.map(param => `
                                    <tr>
                                        <td>${param.parameterOrder}</td>
                                        <td>${param.parameterName}</td>
                                        <td><span class="badge bg-info">${param.dataType}</span></td>
                                        <td>${param.isRequired ? '<span class="badge bg-danger">必填</span>' : '<span class="badge bg-secondary">可选</span>'}</td>
                                        <td><code>${param.exampleValue || '-'}</code></td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } else {
                parametersHtml = '<p class="text-muted">此操作点暂无参数配置</p>';
            }

            content.innerHTML = `
                <div class="row">
                    <div class="col-md-6">
                        <h6>基本信息：</h6>
                        <ul class="list-unstyled">
                            <li><strong>操作点编号：</strong>${operation.operationNumber}</li>
                            <li><strong>操作名称：</strong>${operation.name}</li>
                            <li><strong>操作类型：</strong><span class="badge bg-primary">${operation.operationType}</span></li>
                            <li><strong>操作模式：</strong><span class="badge bg-success">${operation.operationMode}</span></li>
                            <li><strong>状态：</strong>${operation.isEnabled ? '<span class="badge bg-success">启用</span>' : '<span class="badge bg-secondary">禁用</span>'}</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6>描述：</h6>
                        <p>${operation.description || '暂无描述'}</p>
                    </div>
                </div>
                <hr>
                ${parametersHtml}
            `;
        }

        // 从操作点创建题目
        function createQuestionFromOperation() {
            if (selectedOperationNumber) {
                showNotification(`准备从操作点 ${selectedOperationNumber} 创建题目`, 'info');
                // 实际实现中可以跳转到创建题目页面
                // window.location.href = `/ExamManagement/CreateWindowsQuestion?operationNumber=${selectedOperationNumber}`;
            } else {
                showNotification('请先选择一个操作点', 'warning');
            }
        }

        // 刷新操作点
        function refreshOperations() {
            location.reload();
        }

        // 初始化Windows数据
        async function initializeWindowsData() {
            try {
                const response = await fetch('/api/WindowsTest/initialize', {
                    method: 'POST'
                });

                if (response.ok) {
                    showNotification('Windows操作数据初始化成功', 'success');
                    setTimeout(() => {
                        location.reload();
                    }, 1500);
                } else {
                    showNotification('初始化失败', 'danger');
                }
            } catch (error) {
                console.error('初始化失败:', error);
                showNotification('初始化失败', 'danger');
            }
        }

        // 通知函数
        function showNotification(message, type = 'info') {
            // 创建通知元素
            const notification = document.createElement('div');
            notification.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
            notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            notification.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;

            document.body.appendChild(notification);

            // 3秒后自动移除
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }

        // 页面加载完成后的初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Windows操作点页面加载完成');
        });
    </script>
}
