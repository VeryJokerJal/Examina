<?xml version="1.0" encoding="utf-8" ?>
<UserControl x:Class="ExamLab.Views.SpecializedExamPage" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:converters="using:ExamLab.Converters" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:local="using:ExamLab.Views" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d">

    <UserControl.Resources>
        <converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter" />
        <converters:NullToBooleanConverter x:Key="NullToBooleanConverter" />
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <converters:CountToVisibilityConverter x:Key="CountToVisibilityConverter" />
        <converters:BoolToOpacityConverter x:Key="BoolToOpacityConverter" />
    </UserControl.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="300" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!--  左侧专项试卷列表  -->
        <Grid Grid.Column="0" Background="{ThemeResource CardBackgroundFillColorDefault}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!--  专项试卷列表标题  -->
            <TextBlock Grid.Row="0" Margin="16,16,16,8" FontSize="16" FontWeight="SemiBold" Foreground="{ThemeResource TextFillColorTertiaryBrush}" Text="专项试卷" />

            <!--  专项试卷列表  -->
            <Grid Grid.Row="1" Background="{ThemeResource LayerFillColorDefaultBrush}">
                <!-- 空状态提示 -->
                <Border Padding="16" Margin="16"
                        Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}"
                        CornerRadius="8">
                    <StackPanel Spacing="12" HorizontalAlignment="Center">
                        <FontIcon Glyph="&#xE8A5;" FontSize="32" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}" />
                        <TextBlock Text="暂无专项试卷" FontSize="14" FontWeight="Medium" HorizontalAlignment="Center" />
                        <TextBlock Text="点击上方工具栏的新建专项试卷开始创建"
                                   FontSize="12"
                                   Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                                   HorizontalAlignment="Center"
                                   TextWrapping="Wrap" />
                    </StackPanel>
                </Border>

                <!-- 专项试卷ListView -->
                <ListView ItemsSource="{Binding SpecializedExams}"
                          SelectedItem="{Binding SelectedSpecializedExam, Mode=TwoWay}"
                          SelectionMode="Single"
                          Margin="8"
                          Background="Transparent">
                    <ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem">
                            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                            <Setter Property="Padding" Value="0" />
                            <Setter Property="Margin" Value="0,4" />
                            <Setter Property="Background" Value="Transparent" />
                            <Setter Property="BorderThickness" Value="0" />
                        </Style>
                    </ListView.ItemContainerStyle>
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Border Padding="12"
                                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                    BorderBrush="{ThemeResource CardStrokeColorDefaultSolidBrush}"
                                    BorderThickness="1"
                                    CornerRadius="8">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="4" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <!-- 选中状态指示条 -->
                                    <Border Grid.Column="0"
                                            Background="{ThemeResource AccentFillColorDefaultBrush}"
                                            CornerRadius="2" />

                                    <!-- 试卷内容 -->
                                    <StackPanel Grid.Column="1" Margin="12,0,0,0">
                                        <!-- 试卷名称 -->
                                        <TextBlock Text="{Binding Name}"
                                                   FontSize="14"
                                                   FontWeight="SemiBold"
                                                   TextTrimming="CharacterEllipsis" />

                                        <!-- 试卷描述 -->
                                        <TextBlock Text="{Binding Description}"
                                                   FontSize="12"
                                                   Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                                                   TextTrimming="CharacterEllipsis"
                                                   Margin="0,4,0,0" />

                                        <!-- 试卷信息 -->
                                        <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,8,0,0">
                                            <TextBlock FontSize="11"
                                                       Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                                                       Text="专项试卷" />
                                            <TextBlock FontSize="11"
                                                       Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                                                       Text="{Binding LastModifiedTime}" />
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>
        </Grid>

        <!--  右侧内容区域  -->
        <Grid Grid.Column="1">
            <!--  默认显示  -->
            <Border Margin="16" Visibility="{Binding SelectedSpecializedExam, Converter={StaticResource NullToVisibilityConverter}, ConverterParameter=Inverse}">
                <StackPanel VerticalAlignment="Center" Spacing="16">
                    <FontIcon FontSize="48" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}" Glyph="&#xE8A5;" />
                    <TextBlock HorizontalAlignment="Center" FontSize="24" FontWeight="SemiBold" Text="专项试卷制作" />
                    <TextBlock HorizontalAlignment="Center" FontSize="16" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}" Text="请选择左侧的专项试卷开始编辑" />
                    <TextBlock HorizontalAlignment="Center" FontSize="14" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}" Text="或点击工具栏的新建专项试卷创建新的专项试卷" />
                </StackPanel>
            </Border>

            <!--  专项试卷内容显示  -->
            <Grid Visibility="{Binding SelectedSpecializedExam, Converter={StaticResource NullToVisibilityConverter}}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!--  试卷信息头部  -->
                <Border Grid.Row="0" Margin="16,16,16,8" Padding="20" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" BorderBrush="{ThemeResource CardStrokeColorDefaultSolidBrush}" BorderThickness="1" CornerRadius="8">
                    <StackPanel Spacing="12">
                        <!--  试卷标题  -->
                        <TextBlock FontSize="20" FontWeight="SemiBold" Text="{Binding SelectedSpecializedExam.Name}" />

                        <!--  试卷描述  -->
                        <TextBlock FontSize="14" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}" Text="{Binding SelectedSpecializedExam.Description}" TextWrapping="Wrap" />

                        <!--  试卷统计信息  -->
                        <StackPanel Orientation="Horizontal" Spacing="24">
                            <StackPanel Spacing="4">
                                <TextBlock FontSize="12" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}" Text="创建时间" />
                                <TextBlock FontSize="14" Text="{Binding SelectedSpecializedExam.CreatedTime}" />
                            </StackPanel>
                            <StackPanel Spacing="4">
                                <TextBlock FontSize="12" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}" Text="最后修改" />
                                <TextBlock FontSize="14" Text="{Binding SelectedSpecializedExam.LastModifiedTime}" />
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!--  模块内容显示区域  -->
                <ScrollViewer Grid.Row="1" Margin="16,8,16,16">
                    <ContentPresenter Content="{Binding CurrentContentView}" Visibility="{Binding SelectedModule, Converter={StaticResource NullToVisibilityConverter}}" />
                </ScrollViewer>
            </Grid>
        </Grid>
    </Grid>
</UserControl>
