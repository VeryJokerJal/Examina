# ExamLab 导入导出功能使用说明

## 概述

ExamLab现已支持完整的试卷导入导出功能，基于之前创建的Exam模型文档标准，实现了与其他系统的数据交换能力。

## 功能特性

### 1. 保存试卷命令 (SaveExamCommand)
- **功能**: 将当前编辑的试卷保存为JSON文件
- **触发**: 点击保存按钮或使用快捷键
- **流程**:
  1. 数据验证 - 检查试卷数据完整性
  2. 文件选择 - 选择保存位置和文件名
  3. 格式转换 - 转换为标准导出格式
  4. JSON序列化 - 生成格式化的JSON文件
  5. 本地存储 - 同时保存到应用本地数据库

### 2. 导入试卷命令 (ImportExamCommand)
- **功能**: 从JSON文件导入试卷数据
- **支持格式**: JSON (XML格式将在后续版本支持)
- **流程**:
  1. 文件选择 - 选择要导入的试卷文件
  2. 格式验证 - 检查文件类型和内容格式
  3. 版本兼容性检查 - 确保数据版本兼容
  4. 数据解析 - JSON反序列化为数据对象
  5. 模型转换 - 转换为ExamLab内部模型
  6. 数据验证 - 验证导入数据的完整性
  7. 重名处理 - 自动处理重名试卷
  8. 添加到列表 - 添加到试卷管理列表

### 3. 导出试卷命令 (ExportExamCommand)
- **功能**: 将选中试卷导出为JSON文件
- **参数**: CommandParameter="{Binding SelectedExam}"
- **导出级别**:
  - **基本信息**: 仅包含试卷和模块基本信息
  - **完整内容（不含答案）**: 包含题目但不含标准答案和评分规则
  - **完整内容（含答案）**: 包含所有信息，包括答案和评分规则

## 数据格式标准

### JSON导出格式结构
```json
{
  "exam": {
    "id": "试卷ID",
    "name": "试卷名称",
    "description": "试卷描述",
    "examType": "试卷类型",
    "totalScore": 100,
    "durationMinutes": 120,
    "modules": [
      {
        "id": "模块ID",
        "name": "模块名称",
        "type": "模块类型",
        "questions": [
          {
            "id": "题目ID",
            "title": "题目标题",
            "content": "题目内容",
            "operationPoints": [
              {
                "id": "操作点ID",
                "name": "操作点名称",
                "parameters": [
                  {
                    "name": "参数名",
                    "value": "参数值"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  "metadata": {
    "exportVersion": "1.0",
    "exportDate": "导出时间",
    "exportedBy": "ExamLab",
    "totalQuestions": 题目总数,
    "exportLevel": "导出级别"
  }
}
```

## 使用步骤

### 保存试卷
1. 在主界面选择要保存的试卷
2. 点击"保存"按钮
3. 在弹出的文件保存对话框中选择保存位置
4. 输入文件名（系统会自动添加时间戳）
5. 点击"保存"完成操作

### 导入试卷
1. 点击"导入"按钮
2. 在文件选择对话框中选择JSON格式的试卷文件
3. 系统自动进行格式验证和兼容性检查
4. 如有数据问题，系统会显示警告并询问是否继续
5. 确认后试卷将添加到试卷列表中

### 导出试卷
1. 在试卷列表中选择要导出的试卷
2. 点击"导出"按钮
3. 选择导出级别：
   - 基本信息：适用于快速预览
   - 完整内容（不含答案）：适用于学生练习
   - 完整内容（含答案）：适用于教师备课
4. 选择保存位置和文件名
5. 点击"保存"完成导出

## 数据验证

### 导入时验证
- 文件格式检查（JSON格式）
- 版本兼容性检查
- 数据结构完整性验证
- 必填字段检查
- 数据类型验证

### 导出前验证
- 试卷数据完整性检查
- 模块和题目有效性验证
- 操作点配置检查

## 错误处理

### 常见错误及解决方案

1. **文件格式错误**
   - 错误：选择了非JSON格式文件
   - 解决：请选择.json扩展名的文件

2. **JSON解析错误**
   - 错误：文件内容不是有效的JSON格式
   - 解决：检查文件内容是否完整，是否有语法错误

3. **版本不兼容**
   - 错误：导入文件的版本与当前系统不兼容
   - 解决：可选择继续导入（可能有兼容性问题）或联系技术支持

4. **数据验证失败**
   - 错误：导入的数据不符合系统要求
   - 解决：检查数据完整性，补充缺失的必填字段

5. **文件访问权限**
   - 错误：无法读取或写入文件
   - 解决：检查文件权限，选择有写入权限的位置

## 最佳实践

### 导出建议
1. **定期备份**: 建议定期导出试卷作为备份
2. **命名规范**: 使用有意义的文件名，包含日期和版本信息
3. **分级导出**: 根据用途选择合适的导出级别
4. **存储位置**: 选择安全可靠的存储位置

### 导入建议
1. **文件检查**: 导入前先检查文件完整性
2. **备份现有数据**: 导入前备份现有试卷数据
3. **逐步导入**: 大量数据建议分批导入
4. **验证结果**: 导入后检查数据是否正确

## 技术规格

### 支持的文件格式
- **导出**: JSON (.json)
- **导入**: JSON (.json)
- **计划支持**: XML (.xml) - 后续版本

### 文件大小限制
- 建议单个文件不超过10MB
- 支持的最大题目数量：1000题
- 支持的最大操作点数量：10000个

### 性能特性
- 异步处理，不阻塞UI
- 进度提示和错误反馈
- 自动数据验证
- 智能重名处理

## 版本兼容性

### 当前支持版本
- 导出版本：1.0
- 导入版本：1.0

### 向后兼容性
- 系统会尽力保持向后兼容
- 不兼容的版本会显示警告
- 提供数据迁移建议

## 故障排除

如果遇到问题，请按以下步骤排查：

1. **检查文件格式**: 确保文件是有效的JSON格式
2. **验证文件内容**: 使用JSON验证工具检查语法
3. **查看错误信息**: 仔细阅读系统提示的错误信息
4. **重试操作**: 某些临时性错误可通过重试解决
5. **联系支持**: 如问题持续存在，请联系技术支持

## 示例文件

项目中包含了示例导出文件：
- `TestData/SampleExamExport.json` - 完整的试卷导出示例

可以使用此文件测试导入功能，了解标准的数据格式。
