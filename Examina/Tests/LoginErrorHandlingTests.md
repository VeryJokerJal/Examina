# Examina桌面端登录错误提示功能测试指南

## 测试目标
验证增强的登录错误提示功能是否正常工作，确保用户能够获得清晰、友好的错误信息和操作指导。

## 测试环境准备
1. 确保ExaminaWebApplication服务正在运行
2. 确保数据库连接正常
3. 准备测试用户账户和设备数据

## 测试场景

### 1. 网络错误测试
**测试步骤：**
1. 断开网络连接或停止服务器
2. 尝试登录
3. 验证错误提示

**预期结果：**
- 显示网络连接错误信息
- 提供重试按钮
- 错误类型为NetworkError

### 2. 凭据错误测试
**测试步骤：**
1. 输入错误的用户名或密码
2. 点击登录
3. 验证错误提示

**预期结果：**
- 显示"用户名或密码错误"
- 错误类型为InvalidCredentials
- 提供重试按钮

### 3. 短信验证码错误测试
**测试步骤：**
1. 切换到短信登录模式
2. 输入正确手机号但错误的验证码
3. 点击登录
4. 验证错误提示

**预期结果：**
- 显示"短信验证码错误，请重新输入"
- 错误类型为InvalidSmsCode
- 提供重试按钮

### 4. 设备数量超限错误测试（重点测试）
**测试步骤：**
1. 准备一个已绑定最大数量设备的用户账户
2. 在新设备上尝试登录
3. 验证特殊错误提示

**预期结果：**
- 显示设备数量超限专用UI组件
- 包含设备图标和"设备数量超出限制"标题
- 显示当前设备数量和最大允许数量
- 提供"请在设备管理中解绑不需要的设备"建议
- 显示"打开设备管理"按钮
- 错误类型为DeviceLimitExceeded
- CanRetry为false

### 5. 账户锁定测试
**测试步骤：**
1. 使用被锁定的账户尝试登录
2. 验证错误提示

**预期结果：**
- 显示"账户已被锁定，请联系管理员"
- 错误类型为AccountLocked
- 不显示重试按钮

### 6. 服务器错误测试
**测试步骤：**
1. 模拟服务器内部错误（500状态码）
2. 尝试登录
3. 验证错误提示

**预期结果：**
- 显示"服务器内部错误，请稍后重试"
- 错误类型为ServerError
- 提供重试按钮

## UI组件测试

### 1. 设备限制错误UI测试
**验证要点：**
- 设备图标正确显示
- 错误消息格式正确
- 建议操作文本清晰
- "打开设备管理"按钮功能正常
- 点击按钮能正确跳转到设备管理页面

### 2. 一般错误UI测试
**验证要点：**
- 错误图标正确显示
- 错误消息清晰易懂
- 建议操作（如有）正确显示
- 重试按钮在可重试错误时显示
- 重试按钮功能正常

### 3. 响应式设计测试
**验证要点：**
- 在不同窗口尺寸下错误提示正确显示
- 文本换行正常
- 按钮布局合理
- 图标大小适当

## 功能交互测试

### 1. 重试功能测试
**测试步骤：**
1. 触发可重试的错误（如网络错误）
2. 点击重试按钮
3. 验证重新执行登录流程

**预期结果：**
- 清除之前的错误状态
- 重新执行登录逻辑
- 如果条件改善，能够成功登录

### 2. 设备管理跳转测试
**测试步骤：**
1. 触发设备数量超限错误
2. 点击"打开设备管理"按钮
3. 验证跳转功能

**预期结果：**
- 在默认浏览器中打开设备管理页面
- URL正确指向设备管理功能
- 页面能够正常加载

### 3. 错误状态清除测试
**测试步骤：**
1. 触发任意错误
2. 切换登录模式
3. 验证错误状态清除

**预期结果：**
- 错误消息被清除
- 错误相关属性重置
- UI恢复到正常状态

## 数据验证测试

### 1. 错误类型分类测试
**验证要点：**
- 不同HTTP状态码正确映射到对应错误类型
- 特定错误消息正确识别为设备限制错误
- 错误类型枚举值正确设置

### 2. 设备限制信息提取测试
**验证要点：**
- 从API响应中正确提取设备数量信息
- 设备管理URL正确设置
- 错误消息格式正确

## 性能测试

### 1. 错误处理性能
**测试要点：**
- 错误解析不影响登录响应时间
- UI更新流畅无卡顿
- 内存使用正常

### 2. 网络超时处理
**测试要点：**
- 网络超时时能够正确显示错误
- 不会导致应用程序崩溃
- 超时后能够正常重试

## 测试通过标准

### 基本功能
- [ ] 所有错误类型都能正确识别和分类
- [ ] 错误消息用户友好且准确
- [ ] UI组件正确显示和隐藏
- [ ] 重试功能正常工作

### 设备限制特殊处理
- [ ] 设备超限错误能够正确识别
- [ ] 专用UI组件正确显示
- [ ] 设备管理跳转功能正常
- [ ] 错误信息包含具体数量

### 用户体验
- [ ] 错误提示清晰易懂
- [ ] 操作指导明确
- [ ] 界面响应及时
- [ ] 视觉设计一致

### 技术实现
- [ ] 错误处理逻辑健壮
- [ ] 代码结构清晰
- [ ] 性能表现良好
- [ ] 兼容性良好

## 注意事项

1. **测试数据准备**：确保有足够的测试数据来模拟各种错误场景
2. **环境隔离**：在测试环境中进行，避免影响生产数据
3. **日志记录**：注意查看应用程序日志，确保错误被正确记录
4. **边界条件**：测试各种边界条件和异常情况
5. **用户反馈**：收集实际用户的反馈，持续改进错误提示的友好性

## 问题报告模板

**问题描述：**
[详细描述遇到的问题]

**重现步骤：**
1. [步骤1]
2. [步骤2]
3. [步骤3]

**预期结果：**
[描述预期应该发生什么]

**实际结果：**
[描述实际发生了什么]

**环境信息：**
- 操作系统：
- .NET版本：
- 应用程序版本：
- 服务器状态：

**附加信息：**
[任何其他相关信息、截图或日志]
