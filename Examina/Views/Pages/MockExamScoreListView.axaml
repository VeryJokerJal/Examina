<UserControl x:Class="Examina.Views.Pages.MockExamScoreListView"
             xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:Examina.ViewModels.Pages"
             xmlns:local="clr-namespace:Examina.Views.Pages"
             d:DesignHeight="600"
             d:DesignWidth="800"
             x:DataType="vm:MockExamScoreListViewModel"
             mc:Ignorable="d">

    <ScrollViewer>
        <StackPanel Margin="24" Spacing="24">

            <!-- é¡µé¢æ ‡é¢˜ -->
            <StackPanel Spacing="8">
                <TextBlock FontSize="28" FontWeight="Bold" 
                          Foreground="{DynamicResource SystemControlForegroundBaseLowBrush}" 
                          Text="æ¨¡æ‹Ÿè€ƒè¯•æˆç»©" />
                <TextBlock FontSize="14" 
                          Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" 
                          Text="æŸ¥çœ‹æ‚¨çš„åŽ†å²æ¨¡æ‹Ÿè€ƒè¯•æˆç»©è®°å½•" />
            </StackPanel>

            <!-- æ“ä½œæ  -->
            <Border Padding="16" 
                   Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}" 
                   BorderBrush="{DynamicResource SystemAccentColor}" 
                   BorderThickness="1" 
                   CornerRadius="8">
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <Button Content="ðŸ”„ åˆ·æ–°"
                           Command="{Binding RefreshCommand}"
                           IsEnabled="{Binding !IsLoading}"
                           Background="{DynamicResource SystemAccentColor}"
                           Foreground="White"
                           FontSize="13"
                           Padding="16,8"
                           CornerRadius="4" />
                    
                    <TextBlock VerticalAlignment="Center" 
                              FontSize="13" 
                              Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}">
                        <TextBlock.Text>
                            <MultiBinding StringFormat="å…± {0} æ¡è®°å½•">
                                <Binding Path="TotalCount" />
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- åŠ è½½çŠ¶æ€ -->
            <Border Padding="40" 
                   Background="{DynamicResource SystemControlBackgroundChromeMediumBrush}" 
                   BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" 
                   BorderThickness="1" 
                   CornerRadius="8"
                   IsVisible="{Binding IsLoading}">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="16">
                    <ProgressBar IsIndeterminate="True" Width="200" Height="4" 
                                Foreground="{DynamicResource SystemAccentColor}" />
                    <TextBlock HorizontalAlignment="Center" 
                              FontSize="14" 
                              Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" 
                              Text="æ­£åœ¨åŠ è½½æˆç»©è®°å½•..." />
                </StackPanel>
            </Border>

            <!-- é”™è¯¯çŠ¶æ€ -->
            <Border Padding="40" 
                   Background="{DynamicResource SystemControlBackgroundChromeMediumBrush}" 
                   BorderBrush="Red" 
                   BorderThickness="1" 
                   CornerRadius="8"
                   IsVisible="{Binding HasError}">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="16">
                    <TextBlock HorizontalAlignment="Center" 
                              FontSize="48" 
                              Text="âš ï¸" />
                    <TextBlock HorizontalAlignment="Center" 
                              FontSize="16" 
                              Foreground="Red" 
                              Text="åŠ è½½å¤±è´¥" />
                    <TextBlock HorizontalAlignment="Center" 
                              FontSize="14" 
                              Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" 
                              Text="{Binding ErrorMessage}" 
                              TextWrapping="Wrap" />
                    <Button Content="é‡è¯•" 
                           Command="{Binding RefreshCommand}"
                           Background="Red"
                           Foreground="White"
                           Padding="16,8"
                           CornerRadius="4" />
                </StackPanel>
            </Border>

            <!-- æˆç»©åˆ—è¡¨ -->
            <StackPanel IsVisible="{Binding !IsLoading}">
                
                <!-- è¡¨å¤´ -->
                <Border Padding="16,14" 
                       Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}" 
                       BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" 
                       BorderThickness="1" 
                       CornerRadius="4,4,0,0"
                       IsVisible="{Binding HasScores}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="3*" />
                            <ColumnDefinition Width="2*" />
                            <ColumnDefinition Width="2*" />
                            <ColumnDefinition Width="1.5*" />
                            <ColumnDefinition Width="1.5*" />
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" 
                                  FontSize="15" 
                                  FontWeight="SemiBold" 
                                  Foreground="{DynamicResource SystemControlForegroundBaseLowBrush}" 
                                  Text="è€ƒè¯•åç§°" />
                        <TextBlock Grid.Column="1" 
                                  FontSize="15" 
                                  FontWeight="SemiBold" 
                                  Foreground="{DynamicResource SystemControlForegroundBaseLowBrush}" 
                                  Text="å®Œæˆæ—¶é—´" />
                        <TextBlock Grid.Column="2" 
                                  FontSize="15" 
                                  FontWeight="SemiBold" 
                                  Foreground="{DynamicResource SystemControlForegroundBaseLowBrush}" 
                                  Text="ç”¨æ—¶" />
                        <TextBlock Grid.Column="3" 
                                  FontSize="15" 
                                  FontWeight="SemiBold" 
                                  Foreground="{DynamicResource SystemControlForegroundBaseLowBrush}" 
                                  Text="å¾—åˆ†" />
                        <TextBlock Grid.Column="4" 
                                  FontSize="15" 
                                  FontWeight="SemiBold" 
                                  Foreground="{DynamicResource SystemControlForegroundBaseLowBrush}" 
                                  Text="çŠ¶æ€" />
                    </Grid>
                </Border>

                <!-- æˆç»©åˆ—è¡¨é¡¹ -->
                <ItemsControl ItemsSource="{Binding MockExamScores}" IsVisible="{Binding HasScores}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Padding="16,14" 
                                   Background="{DynamicResource SystemControlBackgroundChromeMediumBrush}" 
                                   BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" 
                                   BorderThickness="1,0,1,1">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="3*" />
                                        <ColumnDefinition Width="2*" />
                                        <ColumnDefinition Width="2*" />
                                        <ColumnDefinition Width="1.5*" />
                                        <ColumnDefinition Width="1.5*" />
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                        <TextBlock FontSize="14" 
                                                  FontWeight="SemiBold" 
                                                  Text="{Binding MockExamName}" />
                                        <TextBlock FontSize="12" 
                                                  Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" 
                                                  Text="{Binding MockExamDescription}" 
                                                  IsVisible="{Binding MockExamDescription, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />
                                    </StackPanel>

                                    <TextBlock Grid.Column="1" 
                                              VerticalAlignment="Center" 
                                              FontSize="13" 
                                              Text="{Binding FormattedCompletedAt}" />

                                    <TextBlock Grid.Column="2" 
                                              VerticalAlignment="Center" 
                                              FontSize="13" 
                                              Text="{Binding DurationText}" />

                                    <Border Grid.Column="3" 
                                           Padding="8,4" 
                                           HorizontalAlignment="Left" 
                                           VerticalAlignment="Center" 
                                           Background="{DynamicResource SystemAccentColor}" 
                                           CornerRadius="4">
                                        <TextBlock HorizontalAlignment="Center" 
                                                  FontSize="12" 
                                                  FontWeight="SemiBold" 
                                                  Foreground="White"
                                                  Text="{Binding ScoreText}" />
                                    </Border>

                                    <Border Grid.Column="4" 
                                           Padding="8,4" 
                                           HorizontalAlignment="Left" 
                                           VerticalAlignment="Center" 
                                           CornerRadius="4">
                                        <Border.Background>
                                            <Binding Path="IsPassed" Converter="{x:Static local:PassStatusToColorConverter.Instance}" />
                                        </Border.Background>
                                        <TextBlock HorizontalAlignment="Center" 
                                                  FontSize="12" 
                                                  FontWeight="SemiBold" 
                                                  Foreground="White">
                                            <TextBlock.Text>
                                                <Binding Path="IsPassed" Converter="{x:Static local:PassStatusToTextConverter.Instance}" />
                                            </TextBlock.Text>
                                        </TextBlock>
                                    </Border>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

                <!-- ç©ºçŠ¶æ€ -->
                <Border Padding="40" 
                       Background="{DynamicResource SystemControlBackgroundChromeMediumBrush}" 
                       BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" 
                       BorderThickness="1" 
                       CornerRadius="8"
                       IsVisible="{Binding !HasScores}">
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="16">
                        <TextBlock HorizontalAlignment="Center" 
                                  FontSize="48" 
                                  Opacity="0.5" 
                                  Text="ðŸ“" />
                        <TextBlock HorizontalAlignment="Center" 
                                  FontSize="16" 
                                  Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" 
                                  Text="æš‚æ— æ¨¡æ‹Ÿè€ƒè¯•æˆç»©è®°å½•" />
                        <TextBlock HorizontalAlignment="Center" 
                                  FontSize="14" 
                                  Foreground="{DynamicResource SystemControlForegroundBaseLowBrush}" 
                                  Text="å®Œæˆæ¨¡æ‹Ÿè€ƒè¯•åŽï¼Œæ‚¨çš„æˆç»©è®°å½•å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ" />
                    </StackPanel>
                </Border>

                <!-- åˆ†é¡µæŽ§ä»¶ -->
                <StackPanel Margin="0,16,0,0" 
                           HorizontalAlignment="Center" 
                           Orientation="Horizontal" 
                           Spacing="8"
                           IsVisible="{Binding HasScores}">
                    <Button Content="ä¸Šä¸€é¡µ" 
                           Command="{Binding PreviousPageCommand}"
                           IsEnabled="{Binding CanGoPreviousPage}"
                           Padding="12,6"
                           CornerRadius="4" />
                    
                    <TextBlock VerticalAlignment="Center" 
                              FontSize="14" 
                              Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}">
                        <TextBlock.Text>
                            <MultiBinding StringFormat="ç¬¬ {0} é¡µ">
                                <Binding Path="CurrentPage" />
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>
                    
                    <Button Content="ä¸‹ä¸€é¡µ" 
                           Command="{Binding NextPageCommand}"
                           IsEnabled="{Binding CanGoNextPage}"
                           Padding="12,6"
                           CornerRadius="4" />
                </StackPanel>
            </StackPanel>

        </StackPanel>
    </ScrollViewer>
</UserControl>
