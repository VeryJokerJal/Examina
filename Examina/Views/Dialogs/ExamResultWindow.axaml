<Window x:Class="Examina.Views.Dialogs.ExamResultWindow" xmlns="https://github.com/avaloniaui" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:ui="using:FluentAvalonia.UI.Controls" xmlns:vm="using:Examina.ViewModels.Dialogs" Title="考试结果" Width="600" Height="750" d:DesignHeight="750" d:DesignWidth="600" x:DataType="vm:ExamResultViewModel" CanResize="false" ShowInTaskbar="false" SystemDecorations="Full" WindowStartupLocation="CenterOwner" mc:Ignorable="d">

    <Design.DataContext>
        <vm:ExamResultViewModel />
    </Design.DataContext>

    <!--  Fluent UI 设计的主布局  -->
    <Grid RowDefinitions="Auto,*,Auto">

        <!--  标题栏  -->
        <Border Grid.Row="0" Padding="24,20" Background="{DynamicResource SystemAccentColor}">
            <StackPanel Orientation="Horizontal" Spacing="12">
                <TextBlock VerticalAlignment="Center" FontSize="28" Foreground="White" Text="🎓" />
                <StackPanel VerticalAlignment="Center">
                    <TextBlock FontSize="20" FontWeight="SemiBold" Foreground="White" Text="考试完成" />
                    <TextBlock Margin="0,2,0,0" FontSize="14" Foreground="#E0FFFFFF" Text="{Binding ExamTypeText}" />
                </StackPanel>
            </StackPanel>
        </Border>

        <!--  主内容区域  -->
        <ScrollViewer Grid.Row="1" Padding="24,20,24,0" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
            <StackPanel Spacing="16">

                <!--  考试基本信息卡片  -->
                <Border Padding="20" Background="{DynamicResource SystemControlBackgroundAltHighBrush}" BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" BoxShadow="0 2 8 0 #10000000" CornerRadius="8">
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock VerticalAlignment="Center" FontSize="16" Text="📋" />
                            <TextBlock VerticalAlignment="Center" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource SystemAccentColor}" Text="考试信息" />
                        </StackPanel>

                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="12" RowDefinitions="Auto,Auto" RowSpacing="8">
                            <TextBlock Grid.Row="0" Grid.Column="0" FontWeight="SemiBold" Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}" Text="考试名称：" />
                            <TextBlock Grid.Row="0" Grid.Column="1" Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}" Text="{Binding ExamName}" TextWrapping="Wrap" />

                            <TextBlock Grid.Row="1" Grid.Column="0" FontWeight="SemiBold" Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}" Text="实际用时：" />
                            <TextBlock Grid.Row="1" Grid.Column="1" Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}" Text="{Binding ActualDurationText}" />
                        </Grid>
                    </StackPanel>
                </Border>

                <!--  提交状态卡片  -->
                <Border Padding="20" Background="{DynamicResource SystemControlBackgroundAltHighBrush}" BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" BoxShadow="0 2 8 0 #10000000" CornerRadius="8">
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock VerticalAlignment="Center" FontSize="16" Text="📤" />
                            <TextBlock VerticalAlignment="Center" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource SystemAccentColor}" Text="提交状态" />
                        </StackPanel>

                        <StackPanel HorizontalAlignment="Center" Orientation="Horizontal" Spacing="12">
                            <TextBlock VerticalAlignment="Center" FontSize="24" Text="{Binding SubmissionStatusIcon}" />
                            <TextBlock VerticalAlignment="Center" FontSize="18" FontWeight="SemiBold" Foreground="{Binding SubmissionStatusColor}" Text="{Binding SubmissionStatusText}" />
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!--  成绩信息卡片  -->
                <Border Padding="20" Background="{DynamicResource SystemControlBackgroundAltHighBrush}" BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="1" BoxShadow="0 2 8 0 #10000000" CornerRadius="8" IsVisible="{Binding IsSubmissionSuccessful}">
                    <StackPanel Spacing="16">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock VerticalAlignment="Center" FontSize="16" Text="📊" />
                            <TextBlock VerticalAlignment="Center" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource SystemAccentColor}" Text="考试成绩" />
                        </StackPanel>

                        <!--  得分显示  -->
                        <StackPanel HorizontalAlignment="Center" Spacing="16">
                            <!--  评分状态显示  -->
                            <StackPanel HorizontalAlignment="Center" IsVisible="{Binding IsScoring}" Orientation="Horizontal" Spacing="12">
                                <ui:ProgressRing Width="24" Height="24" IsActive="{Binding IsScoring}" />
                                <TextBlock VerticalAlignment="Center" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" Text="正在计算成绩..." />
                            </StackPanel>

                            <!--  得分显示  -->
                            <TextBlock HorizontalAlignment="Center" FontSize="36" FontWeight="Bold" Foreground="{DynamicResource SystemAccentColor}" IsVisible="{Binding !IsScoring}" Text="{Binding ScoreText}" />
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!--  错误信息卡片  -->
                <Border Padding="20" Background="#FFF4F4" BorderBrush="#FFB3B3" BorderThickness="1" BoxShadow="0 2 8 0 #10000000" CornerRadius="8" IsVisible="{Binding HasError}">
                    <StackPanel Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock VerticalAlignment="Center" FontSize="16" Text="⚠️" />
                            <TextBlock VerticalAlignment="Center" FontSize="16" FontWeight="SemiBold" Foreground="#D32F2F" Text="错误信息" />
                        </StackPanel>
                        <TextBlock Foreground="#B71C1C" LineHeight="20" Text="{Binding ErrorMessage}" TextWrapping="Wrap" />
                    </StackPanel>
                </Border>

                <!--  备注信息卡片  -->
                <Border Padding="20" Background="#F1F8E9" BorderBrush="#C8E6C9" BorderThickness="1" BoxShadow="0 2 8 0 #10000000" CornerRadius="8" IsVisible="{Binding HasNotes}">
                    <StackPanel Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock VerticalAlignment="Center" FontSize="16" Text="💡" />
                            <TextBlock VerticalAlignment="Center" FontSize="16" FontWeight="SemiBold" Foreground="#2E7D32" Text="备注信息" />
                        </StackPanel>
                        <TextBlock Foreground="#1B5E20" LineHeight="20" Text="{Binding Notes}" TextWrapping="Wrap" />
                    </StackPanel>
                </Border>

                <!--  温馨提示卡片  -->
                <Border Padding="16" Background="#FFF8E1" BorderBrush="#FFCC02" BorderThickness="1" BoxShadow="0 2 8 0 #10000000" CornerRadius="8">
                    <StackPanel Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock VerticalAlignment="Center" FontSize="14" Text="📝" />
                            <TextBlock VerticalAlignment="Center" FontSize="14" FontWeight="SemiBold" Foreground="#E65100" Text="温馨提示" />
                        </StackPanel>
                        <TextBlock FontSize="12" Foreground="#BF360C" LineHeight="18" Text="考试结果已保存，您可以在成绩查询页面查看详细信息。" TextWrapping="Wrap" />
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>

        <!--  底部按钮区域  -->
        <Border Grid.Row="2" Padding="24,16" Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}" BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}" BorderThickness="0,1,0,0">
            <StackPanel HorizontalAlignment="Right" Orientation="Horizontal" Spacing="12">
                <Button Name="ConfirmButton" MinWidth="120" Padding="24,10" Background="{DynamicResource SystemAccentColor}" BorderThickness="0" Click="ConfirmButton_Click" Content="确认" CornerRadius="4" FontSize="14" FontWeight="SemiBold" Foreground="White">
                    <Button.Styles>
                        <Style Selector="Button:pointerover">
                            <Setter Property="Background" Value="{DynamicResource SystemAccentColorDark1}" />
                        </Style>
                        <Style Selector="Button:pressed">
                            <Setter Property="Background" Value="{DynamicResource SystemAccentColorDark2}" />
                        </Style>
                    </Button.Styles>
                </Button>
            </StackPanel>
        </Border>
    </Grid>
</Window>
